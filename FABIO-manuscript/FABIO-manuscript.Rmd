---
title: Experimental methodology for testing effects of variation in naturally structured fine fuel loads on fire intensity

author:
- affilnum: 1
  email: wdillon@ufl.edu/whalendillon@gmail.com
  name: Whalen W. Dillon
- affilnum: 1
  name: Drew T. Hiatt
- affilnum: 1
  name: S. Luke Flory
affiliation:
- affil: Agronomy Department, University of Florida, Gainesville, FL, 32611, USA
  affilnum: 1
# - affil: null
#   affilnum: 2
# - affil: null
#   affilnum: 3
output:
  pdf_document:
    fig_caption: yes
    #fig_height:
    fig_width: 7.5
    includes:
      in_header: header.tex
    keep_tex: yes
    number_sections: no
    template: manuscript.latex
  html_document: null
  word_document: null
capsize: normalsize
classoption: a4paper
csl: ecology.csl
documentclass: article
fontsize: 11pt
footerdate: yes
geometry: margin=1in
linenumbers: yes
bibliography:
- references.bib
- knitcitations.bib
spacing: doublespacing
abstract: no
---


```{r setup, include=FALSE, cache=FALSE, message = FALSE}

library(knitr); library(plyr); library(dplyr); library(readr); library(ggplot2)

#opts_knit$set(root.dir=normalizePath('../'))

### Chunk options: see http://yihui.name/knitr/options/ ###

## Text results
opts_chunk$set(echo = F, warning = F, message = F, include = TRUE)

## Code decoration
opts_chunk$set(tidy = TRUE, comment = NA, highlight = TRUE)

## Cache
opts_chunk$set(cache = 2, cache.path = "cache/")

## Plots
opts_chunk$set(fig.path = "figures/")
opts_chunk$set(dpi = 600)
opts_chunk$set(dev = c("pdf","png"))

```


```{r knitcitations, cache = F}

library(knitcitations)
cleanbib()   
cite_options(citation_format = "pandoc")
library(bibtex)
library(RefManageR)

```

\singlespace

\vspace{2mm}\hrule

Write your abstract here.

\vspace{3mm}\hrule

*Keywords*: experiment, fire intensity, fuel load, fuel characteristics, FABIO, Fine Aboveground Biomass Incineration Organizer

\doublespace

\bleft


# INTRODUCTION

1. Fuel characteristics - load (mass), structure, type, moisture, particle size - drive fire intensity and severity.


2. Studies in fire ecology that experimentally manipulate fuel characteristics often only change the fuel load and/or type of fuel, sacrificing some realism in fuel structure.

3. We present a methodology for maintaining realism in fuel structure in experiments where fine fuels with typical vertical structure, e.g. grasses, are manipulated.

4. We demonstrate how the Fire Aboveground Biomass Incineration Organizer (FABIO) maintains realistic fuel structure while experimentally manipulating other fuel characteristics. It can also be deployed in the field or in a more controlled "laboratory" setting. Using the exotic invasive cogongrass, we illustrate how changing the fuel structure can substantially alter flammability characteristics.


## Compare Temperature Metrics to piled fuels in Bowman et al. 2017

`r citep("Bowman 2017 Journal of Ecology")` *Differential demographic filtering by surface fires: How fuel type and fuel load affect sapling mortality of an obligate seeder savanna tree.*

In this study, "Grass fuels had to be laid horizontally rather than standing vertically." The context provided is that the native sorghum grass flattens easily after it dries and does not remain vertical throughout the dry season. 

- This reads like a response to a reviewer comment, which might indicate a gap that the FABIO methodology can fill. 

- Average flame height was measured "when the fire was within 15cm of the tree stem using a metal grid placed verically against a steel picket placed next to the stem."

Additional references given where fuels have been laid flat when testing flammability:

1. `r citep("Jaureguiberry 2011 Austral Ecology")`

    - Built the "Bar-B-Q"" apparatus to fill a need to quantify flammability of whole plants of many species
    
    - Quantified flammability characteristics of 34 species using "whole plant"
    
    - Fuels are still burnt horizontally, so no vertical structure
    
    - Length of fuel limited by size of burning surface

2. `r citep("Simpson 2016 Journal of Ecology")`

3. `r citep("Wyse 2016 International Journal of Wildland Fire")`

All of these studies assessed flammability of multiple species, or multiple fuel complexes.

Temperature metrics are influenced by fuel structure. In general, fuels with greater vertical arrangement will achieve higher maxium temperatures, but will also burn faster. Faster burning should result in less exposure above temperature thresholds that cause tissue damage to plants. We show these differences in maximum temperature and time above 100 ºC for standing and piled fuels.


Write your introduction here. You can cite bibliography like this [@Yan2011; @Sutherland2011], if you provide a `BibTeX` file with references. See http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html for more information. Or you could also use [knitcitations](https://cran.r-project.org/web/packages/knitcitations/index.html) or [RefManageR](https://cran.r-project.org/web/packages/RefManageR/index.html) to fetch bibliographic metadata automatically from the web. For example, citing a paper can be as easy as providing its DOI `r citep("10.1016/j.tree.2006.03.016")` or even just a few keywords `r citep("Ricklefs 2008 American Naturalist")`. They will then automagically appear in the list of cited references.

You can even specifiy the desired output format for your bibliography by including a style file for a specific journal (e.g. "ecology.csl"). Many different bibliography styles (CSL files) can be obtained at http://citationstyles.org/ or https://github.com/citation-style-language/styles.



# METHODS


## Study Area

We worked in a **beautiful** place with lots of trees, like *Quercus suber* and *Laurus nobilis*.


## Data collection and analysis

```{r load data from FABIO experiment}
fabio_fires_biomass <- read_csv("~/Documents/SERDP_Project/data/fabio-fires-biomass.csv")
pile_vs_stand <- filter(fabio_fires_biomass, date > "2017-11-30")

# fabio_burns <- read_csv("~/Documents/SERDP_Project/data/experimental-fire-data-summary.csv")
# fabio_burns <- mutate(fabio_burns, source = "FABIO Burn (vertical)")
```


```{r compare_maxtemp}

# bowman_maxtemp <- read_csv("~/Documents/SERDP_Project/data/bowman-etal-maxtemp.csv")
# bowman_maxtemp$source <- "Piled (Bowman et al.)"
# 
# # names(bowman_maxtemp)
# bowman_maxtemp <- filter(bowman_maxtemp, biomass_type == "grass")
# fabio_maxtemp <- fabio_burns %>% 
#       filter(litter_biomass == 0, biomass_type == "cogongrass", pct_green == 25, standing_biomass < 2000) %>% 
#       select(standing_biomass, max_temp, location, biomass_type, source) %>% 
#       rename(biomass = standing_biomass, tempC = max_temp)
# 
# maxtemp_df <- rbind(bowman_maxtemp,fabio_maxtemp)
# maxtemp_df <- maxtemp_df %>% 
#       filter(location != "25cm")
# # unique(maxtemp_df$location)
# maxtemp_df$location[maxtemp_df$location!="50cm"] <- "near ground"

maxtemp_comparison <- ggplot(maxtemp_df, aes(biomass, tempC)) +
      geom_line(aes(color = source, linetype = location)) +
      geom_point(shape = 21, fill = "white", size = 2) +
      scale_shape_manual(values = 21) +
      scale_color_discrete(h.start = 20) +
      theme_bw()
maxtemp_comparison +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Maximum Temperature ºC") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            legend.position = c(.02,.98),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )

```      


```{r compare_sAbv100 }

bowman_s_abv100 <- read_csv("~/Documents/SERDP_Project/data/bowman-etal-s_abv100.csv")
bowman_s_abv100$source <- "Piled (Bowman et al.)"

# names(bowman_s_abv100)
bowman_s_abv100 <- filter(bowman_s_abv100, biomass_type == "grass")
fabio_s_abv100 <- fabio_burns %>% 
      filter(litter_biomass == 0, biomass_type == "cogongrass", pct_green == 25, standing_biomass < 2000) %>% 
      select(standing_biomass, s_abv100, location, biomass_type, source) %>% 
      rename(biomass = standing_biomass)

s_abv100_df <- rbind(bowman_s_abv100, fabio_s_abv100)
s_abv100_df <- s_abv100_df %>% 
      filter(location != "25cm")
# unique(s_abv100_df$location)
s_abv100_df$location[s_abv100_df$location!="50cm"] <- "near ground"

s_abv100_comparison <- ggplot(s_abv100_df, aes(biomass, s_abv100)) +
      geom_line(aes(color = source, linetype = location)) +
      scale_color_discrete(h.start = 20) +
      geom_point(shape = 21, fill = "white", size = 2) +
      scale_shape_manual(values = 21) +
      theme_bw()
s_abv100_comparison +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Seconds above 100 ºC") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            legend.position = c(.02,.98),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )

```


```{r compare flame height}

# bowman_flame_ht <- read_csv("~/Documents/SERDP_Project/data/bowman-etal-flame-height.csv")
# bowman_flame_ht$source <- "Piled (Bowman et al.)"
# 
# bowman_flame_ht <- filter(bowman_flame_ht, biomass_type == "grass")
# fabio_flame_ht <- fabio_burns %>% 
#       filter(litter_biomass == 0, biomass_type == "cogongrass", 
#              pct_green == 25, standing_biomass < 2000, max_flame_ht != -Inf,
#              location == "0cm") %>% 
#       select(standing_biomass, max_flame_ht, biomass_type, source) %>%
#       rename(biomass = standing_biomass)
# 
# max_flame_ht_df <- rbind(bowman_flame_ht, fabio_flame_ht)

ggplot(pile_vs_stand, aes(biomass, max_flame_ht)) +
      # geom_line(aes(color = structure)) +
      geom_point(aes(color = structure), size = 3) +
      geom_smooth(aes(color = structure), method = "lm") +
      scale_color_discrete(h.start = 20) +
      theme_bw() +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Max flame height (cm)") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            legend.position = c(.02,.98),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )

ggplot(pile_vs_stand, aes(biomass, avg_flame_ht, color = structure)) +
      geom_point(aes(color = structure), size = 3) +
      geom_smooth(aes(color = structure), method = "lm") +
      scale_color_discrete(h.start = 20) +
      theme_bw() +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Average flame height (cm)") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            legend.position = c(.02,.98),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )


# d1 <- pile_vs_stand
# d1$biomass[d1$fire_id==59|d1$fire_id==60] <- 1200
# 
# a <- ggplot(pile_vs_stand, aes(biomass, avg_fuel_ht, color = structure)) +
#       geom_point(aes(color = structure), size = 3) +
#       scale_color_discrete(h.start = 20) +
#       theme_bw() +
#       ggtitle("Kept at 1500g")
# b <- ggplot(d1, aes(biomass, avg_fuel_ht, color = structure)) +
#       geom_point(aes(color = structure), size = 3) +
#       scale_color_discrete(h.start = 20) +
#       theme_bw() +
#       ggtitle("Changed to 1000g")
# 
# c <- xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
#       # ylab("Average fuel height (cm)") +
#       theme(legend.title = element_blank(), 
#             # legend.direction = "vertical",
#             # legend.position = c(.02,.98),
#             legend.justification = c("left","top"),
#             legend.spacing = unit(x = -.3, units = "cm"),
#             axis.title = element_text(size = 16),
#             axis.text = element_text(size = 12),
#             plot.margin = unit(c(.5,.5,.5,.5), "cm")
#             )
# 
# a1 <- a + c 
# a2 <- b + c
# 
# library(cowplot)
# plot_grid(a1, a2)

```

```{r compare biomass consumption}

# ggplot(pile_vs_stand, aes(biomass, remaining_biomass, color = structure)) +
#       geom_point(size = 2, position = "jitter") +
#       scale_color_discrete(h.start = 20) +
#       theme_bw()

ggplot(pile_vs_stand, aes(biomass, pct_consumed)) +
      # geom_line(aes(color = structure)) +
      geom_point(aes(color = structure), size = 3) +
      scale_color_discrete(h.start = 20) +
      theme_bw() +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Percent consumed") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            legend.position = c(.8,.4),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )

# ggplot(pile_vs_stand, aes(biomass, pct_consumed, color = structure)) +
#       geom_point(size = 2) +
#       scale_color_discrete(h.start = 20) +
#       theme_bw()


ggplot(d1, aes(biomass, rate_of_spread_50cm, color = structure)) +
      geom_point(size = 3) +
      scale_color_discrete(h.start = 20) +
      theme_bw() +
      xlab(expression(paste("Fuel load (g/", m^{2}, ")"))) +
      ylab("Rate of spread (s/50cm") +
      theme(legend.title = element_blank(), 
            # legend.direction = "vertical",
            # legend.position = c(.02,.98),
            legend.justification = c("left","top"),
            legend.spacing = unit(x = -.3, units = "cm"),
            axis.title = element_text(size = 16),
            axis.text = element_text(size = 12),
            plot.margin = unit(c(.5,.5,.5,.5), "cm")
            )

```


We applied a linear model where

$$
y_{i} = \alpha + \beta*x_{i} 
$$

```{r model, echo = FALSE, eval = FALSE}
model <- lm(y ~ x)
```

We used the statistical language `R` `r citep(citation())` for all our analyses. These were implemented in dynamic rmarkdown documents using `knitr` `r citep(citation("knitr"))` and `rmarkdown` `r citep(citation("rmarkdown"))` packages. All the multilevel models were fitted with `lme4` `r citep(citation("lme4"))`. 



# RESULTS

Trees in forest A grew taller than those in forest B (mean height: `r mean(25, 31, 28)` versus `r mean(13, 19, 16)` m). And many more cool results that get updated dynamically.




# DISCUSSION

Discuss.



# CONCLUSIONS



# ACKNOWLEDGEMENTS



# REFERENCES

```{r write_citations, cache=FALSE, include=FALSE}
write.bibtex(file="knitcitations.bib")
```

<div id = "refs"></div>


\eleft

\clearpage


\listoftables


\newpage

```{r Table1, results='asis', echo=FALSE, cache=FALSE}
kable(head(iris), caption = "A glimpse of the famous *Iris* dataset.")
```


\newpage

```{r Table2, results='asis', echo=FALSE, cache=FALSE}
kable(mtcars[10:16, ], caption = "Now a subset of mtcars dataset.")
```


\clearpage

\listoffigures


\newpage

```{r Fig1, echo=FALSE, fig.cap="Just my first figure with a very fantastic caption.", cache=FALSE}
x <- rnorm(100)
y <- jitter(x, 1000)
plot(x, y)
```

\newpage

\blandscape

```{r Fig2, echo=FALSE, fig.cap="Second figure in landscape format.", cache=FALSE}
a <- sort(rnorm(100))
b <- c(rep("Group Small", 35), rep("Group Big", 65))
boxplot(a ~ b)
```

\elandscape

\clearpage



```{r sessioninfo, echo = FALSE, eval = FALSE}
# set eval = FALSE if you don't want this info (useful for reproducibility) to appear 
sessionInfo()
```

