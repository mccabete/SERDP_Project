---
title: 'Installation Report: `r params$inst_name`'
author:
- "SERDP Project RC-2636"
- "Report authors: Whalen W. Dillon, Drew T. Hiatt, Steven Cabrera"
- "Project principal investigators: Brian Allan, S. Luke Flory, Mike Dietze"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: no
    toc: yes
    toc_float: yes
  word_document:
    toc: yes
    reference_docx: rmarkdown_styles.docx
  pdf_document:
    toc: yes
subtitle: <h1>Climate change impacts on fire regimes, plant invasions, and tick-borne
  diseases<h1>
params:
  inst_name: Fort Jackson
---



```{r set installation name options, echo=F}
# inst_name values 
# 1 "Avon Park AFR"
# 2 "Camp Blanding"
# 3 "Camp Shelby"
# 4 "Eglin AFB"
# 5 "Fort Benning"
# 6 "Fort Gordon"
# 7 "Fort Jackson"
# 8 "Moody AFB"
# 9 "Tyndall AFB"
```

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(warning = F)
knitr::opts_chunk$set(message = F)
knitr::opts_chunk$set(dpi = 150)

library(plyr); library(dplyr); library(ggplot2); library(readr)
library(stringi); library(stringr)
library(tidyr)
library(viridisLite); library(viridis)

def_theme <- theme(legend.title = element_blank(),
            legend.text = element_text(size = 12),
            legend.position = "top",
            axis.text = element_text(size = 12),
            axis.title = element_text(size = 16),
            plot.title = element_text(size = 28),
            strip.background = element_blank(),
            panel.grid = element_blank()
            )
invasion_color <- scale_color_viridis_d()
invasion_fill <- scale_fill_viridis_d()
installation_color <- "blue"

```

```{r knitcitations, cache = F}

library(knitcitations)
cleanbib()   
cite_options(citation_format = "pandoc")
library(bibtex)
library(RefManageR)

```

```{r set installation name, echo=F}

## set installation name from yaml header parameter
inst_name = params$inst_name

```

```{r load plot visit data processing ASK ABOUT WORDING OF PLOT VISIT VS TOTAL}

plot_visit_data <- read_csv("data/processed_data/plot_visit_data.csv")
plot_visit_data$imcy_inv <- factor(plot_visit_data$imcy_inv, levels=c("uninvaded","invaded"), labels = c("Uninvaded","Invaded"))

n_plots <- filter(plot_visit_data, installation_full_name==inst_name)
n_plots <- n_distinct(n_plots$plot_id)

n_fire_yrs <- 
      plot_visit_data %>% 
      filter(installation_full_name==paste(inst_name)) %>% 
      n_distinct(.$years_since_fire)

n_total_plots_all <- n_distinct(plot_visit_data$plot_id)
n_total_plots_all_invaded <- n_distinct(filter(plot_visit_data, imcy_inv=="Invaded"))

n_plots_invaded_inst <- n_distinct(filter(plot_visit_data, imcy_inv=="Invaded" &  installation_full_name==paste(inst_name)))
                              
```

```{r woody 100m subplot for processing for tick dependency, results='hide'}

subplot_data_import <- read_csv("data/processed_data/woodysubplot.csv")

subplot_data <- left_join(
      select(subplot_data_import, -notes),
      select(plot_visit_data, -notes)
)

subplot_plot_summary <- subplot_data %>% 
      group_by(plot_id, visit_year, imcy_inv, years_since_fire, installation_full_name) %>% 
      summarise(shrub_sap_rich = n_distinct(veg_id),
                total_stems_100m2 = sum(stems_100m2))
```

```{r load 25cm biomass data and processing, results='hide'}

biomass_data_import <- read_csv("data/processed_data/quadrat25cm.csv")

biomass_data <- biomass_data_import %>% 
      mutate(pct_litter_moisture = 100*(litter_mass_wet-litter_mass_dry)/litter_mass_wet)
summary(biomass_data)
biomass_data <- biomass_data %>% 
      mutate(pct_litter_moisture = ifelse(pct_litter_moisture<0,0,pct_litter_moisture))

biomass_data <- left_join(
      select(biomass_data, -Notes),
      select(plot_visit_data, -notes))
summary(biomass_data)

biomass_plot_summary <- biomass_data %>% 
      group_by(plot_id, visit_year, years_since_fire, imcy_inv, installation_full_name) %>% 
      mutate(standing_gm2 = standing_fuel_mass_wet*16,
             litter_gm2 = litter_mass_wet*16,
             dry_standing_gm2 = standing_fuel_mass_dry*16,
             dry_litter_gm2 = litter_mass_dry*16) %>% 
      summarise(avg_dry_standing_gm2 = mean(dry_standing_gm2),
                se_dry_standing_gm2 = sd(dry_standing_gm2)/sqrt(length(dry_standing_gm2)),
                avg_dry_litter_gm2 = mean(dry_litter_gm2),
                se_litter = sd(dry_litter_gm2)/sqrt(length(dry_litter_gm2)),
                avg_pct_litter_moisture = mean(pct_litter_moisture))
summary(biomass_plot_summary)

biomass_plot_summary <- filter(biomass_plot_summary, !is.na(years_since_fire))
```

```{r load canopy cover data, eval = T}

canopy_cover <- read_csv("data/processed_data/canopy-cover.csv")
  
canopy_cover_summary <- canopy_cover %>%
      filter(distance == 10) %>% 
      group_by(installation, plot_id, visit_year) %>%
      summarise(avg_canopy_cover = mean(pct_canopy_cover),
                sd_canopy_cover = sd(pct_canopy_cover),
                n_obs = length(pct_canopy_cover),
                se_canopy_cover = sd_canopy_cover/sqrt(n_obs))
# summary(canopy_cover_summary)

canopy_cover_summary <- left_join(canopy_cover_summary, plot_visit_data)

```

```{r load 1m quadrat data and summarise}

quadrat_data <- read_csv("data/processed_data/quadrat1m.csv")

quadrat_data <- left_join(
      select(quadrat_data, -notes),
      select(plot_visit_data, -notes))

quadrat10_data <- filter(
      quadrat_data, quadrat_id %in% c("e10","w10","n10","s10"
      ))                         

quadrat10_summaries <- quadrat10_data %>%
      group_by(plot_id, visit_year, installation) %>%
      summarise(
            avg_woody_ht1 = mean(woody_veg_ht1),
            avg_woody_ht_all = mean(
                  c(woody_veg_ht1,woody_veg_ht2,woody_veg_ht3), na.rm = T),
            avg_herb_ht1 = mean(herb_veg_ht1),
            avg_herb_ht_all = mean(c(herb_veg_ht1, herb_veg_ht2, herb_veg_ht3), na.rm = T),
            avg_litter_depth1 = mean(litter_ht1),
            avg_litter_depth_all =
                  mean(c(litter_ht1,litter_ht2,litter_ht3), na.rm = T),
            avg_pct_green = mean(pct_green),
            avg_pct_litter = mean(pct_litter),
            avg_pct_wood = mean(pct_wood_litter),
            avg_pct_bare = mean(pct_bare))

quadrat10_summaries <- left_join(
      quadrat10_summaries,
      plot_visit_data
)
```

```{r load species data}

species_data_import <- read_csv("data/processed_data/species1m.csv")

species_data <- left_join(
      select(species_data_import, installation:visit_year),
      select(plot_visit_data, -notes)
)
species_data$functional_group <- tolower(species_data$functional_group)

species10_data <- species_data %>% 
      filter(quadrat_id %in% c("e10","w10","n10","s10"))
veg_cover_data <- species10_data %>% arrange(date) %>% 
      group_by(installation, plot_id, visit_year, functional_group) %>% 
      summarise(
            total_pct_cover = sum(pct_cover),
            avg_pct_cover = mean(pct_cover)
      )
veg_cover_data <- left_join(
      veg_cover_data,
      plot_visit_data)

veg_cover_plot_data <- species10_data %>%
      group_by(installation_full_name, visit_year, plot_id, imcy_inv, years_since_fire, quadrat_id) %>%
      summarise(veg_cover = sum(pct_cover, na.rm = T)) %>% 
      ungroup(.) %>% 
      group_by(plot_id, visit_year, imcy_inv, years_since_fire, installation_full_name) %>% 
      summarise(
            plot_avg_veg_cover = mean(veg_cover, na.rm = T),
            n_obs = length(veg_cover),
            max_veg_cover = max(veg_cover, na.rm = T),
            sd_veg_cover = sd(veg_cover, na.rm = T),
            se_veg_cover = sd_veg_cover / sqrt(n_obs)) %>% 
      ungroup(.)
```

```{r species richness data processing}

species_richness <- species10_data %>%
      group_by(installation_full_name, years_since_fire, imcy_inv, plot_id) %>%
      summarise(richness = n_distinct(scientific_name)) %>% 
      mutate(ln_richness = log(richness),
             max_richness = max(richness))

invaded_quadrats <- species10_data %>% 
      filter(scientific_name=="Imperata cylindrica") %>% 
      mutate(quadrat_invaded = "yes") %>% 
      select(installation:quadrat_id, quadrat_invaded, years_since_fire, installation_full_name)

species10_data <- left_join(species10_data, invaded_quadrats)
species10_data$quadrat_invaded[is.na(species10_data$quadrat_invaded)] <- "no"

quadrat_species_richness <- species10_data %>%
      group_by(installation_full_name, years_since_fire, plot_id, quadrat_invaded, quadrat_id) %>%
      summarise(richness = n_distinct(scientific_name)) %>% 
      mutate(ln_richness = log(richness),
             max_richness = max(richness),
             invasion_status = factor(quadrat_invaded, levels = c("no","yes"), labels = c("Uninvaded","Invaded")))

```

```{r load tree data, results='hide'}

tree_data_import <- read_csv("data/processed_data/trees.csv")

tree_data <- tree_data_import %>% 
      select(installation:date, species:canopy, height, char)

tree_data <- left_join(
      tree_data,
      select(plot_visit_data, -notes)) %>% 
      rename(tree_id = species) %>% 
      mutate(labels = "")
tree_data$tree_id <- tolower(tree_data$tree_id)

tree_data$labels[agrep("qu", tree_data$tree_id, max.distance = 0)] <- "Quercus"
tree_data$labels[agrep("pi", tree_data$tree_id, max.distance = 0)] <- "Pinus"
tree_data$labels[!(tree_data$labels %in% c("Quercus","Pinus"))] <- "Other"

tree_grp_summary <- tree_data %>% 
      filter(health!=0) %>% 
      group_by(plot_id, labels, years_since_fire, imcy_inv, visit_year) %>% 
      summarise(
            total_dbh_cm = sum(dbh, na.rm = T),
            avg_dbh_cm = mean(dbh, na.rm = T),
            n_stems = length(tree_id))

dbh_by_tree_grp <- tree_grp_summary %>% 
      select(-avg_dbh_cm, -n_stems) %>% 
      spread(labels, total_dbh_cm) %>% 
      mutate(Quercus = if_else(is.na(Quercus)==TRUE,0,Quercus),
                   Pinus = if_else(is.na(Pinus)==TRUE,0,Pinus),
                   Other = if_else(is.na(Other)==TRUE,0,Other),
                   total_dbh = rowSums(cbind(Other,Pinus,Quercus), na.rm = T),
                   pct_pinus_dbh = 100*(Pinus/total_dbh))


tree_data_plot_summary <- tree_data %>% 
      filter(health!=0) %>% 
      group_by(plot_id, years_since_fire, imcy_inv, visit_year, installation_full_name) %>% 
      summarise(
            total_dbh = sum(dbh, na.rm = T),
            richness = n_distinct(tree_id),
            avg_tree_ht = mean(height, na.rm = T),
            avg_char_ht = mean(char, na.rm = T))

tree_data_plot_summary <- left_join(
      tree_data_plot_summary, 
      select(dbh_by_tree_grp, plot_id:visit_year, pct_pinus_dbh)
      )

```

```{r load dung data and process, results='hide'}

dung_data_import <- read_csv("data/processed_data/dung.csv")
dung_data_import$species[is.na(dung_data_import$species) & dung_data_import$dung1m>0] <- "other"
dung_data_import$species[is.na(dung_data_import$species) & dung_data_import$dung2m>0] <- "other"

dung_data <- dung_data_import 

dung_data <- left_join(
      dung_data,
      select(plot_visit_data, -notes))
summary(dung_data)
filter(dung_data, is.na(years_since_fire))$plot_id

dung_plot_data <- dung_data %>% 
      group_by(installation, plot_id, visit_year, years_since_fire, imcy_inv, species, installation_full_name) %>% 
      summarise(
            total_clusters1m = sum(dung1m, na.rm = T),
            avg_clusters1m = mean(dung1m, na.rm = T),
            total_clusters2m = sum(rowSums(cbind(dung1m,dung2m), na.rm=T)),
            avg_clusters2m = mean(rowSums(cbind(dung1m,dung2m), na.rm=T))
                )
summary(dung_plot_data)
```

```{r import tick data, results='hide'}

tick_data <- read_csv("data/processed_data/ticks.csv")

tick_data <- left_join(
      select(tick_data, -notes),
      select(plot_visit_data, -notes)
)

tick_data$life_stage <- factor(
      tick_data$life_stage, 
      levels = c("A","N","L"),
      labels = c("Adult","Nymph","Larval"))

tick_data <- tick_data %>% 
      mutate(tick_count = ifelse(life_stage=="Larval",1,count),
             tick_count = ifelse(is.na(tick_count),0,tick_count))

total_ticks <- tick_data %>% 
      filter(installation_full_name==inst_name) %>%
      summarise(tick_count_sum = sum(tick_count, na.rm = T))

```

```{r summarize-tick-abundance-data, results='hide'}

tick_data_life_stage_summary <- tick_data %>% 
      group_by(plot_id, visit_year, life_stage, years_since_fire, imcy_inv, installation_full_name, date) %>% 
      summarise(total_ticks = sum(tick_count)) %>% 
      ungroup(.)

summary(tick_data)


tick_data_plot_summary <- tick_data %>% 
      group_by(installation, plot_id, visit_year, years_since_fire, imcy_inv, installation_full_name) %>% 
      summarise(total_ticks = sum(tick_count)) %>% 
      ungroup(.)

summary(tick_data_plot_summary)
filter(tick_data_plot_summary, is.na(years_since_fire))$plot_id
filter(tick_data_plot_summary, is.na(imcy_inv))$plot_id

tick_biomass_data <- left_join(
      tick_data_plot_summary, 
      ungroup(biomass_plot_summary))

tick_quad10_data <- left_join(
      tick_data_plot_summary,
      select(ungroup(quadrat10_summaries), -notes, -visit_date))

tick_vegcover_data <- left_join(
      tick_data_plot_summary,
      ungroup(veg_cover_plot_data)
)

tick_canopycover_data <- left_join(
      tick_data_plot_summary, 
      ungroup(canopy_cover_summary))

tick_host_data <- left_join(
      tick_data_plot_summary, 
      dung_plot_data %>% 
            ungroup(.) %>% 
            group_by(plot_id, visit_year, years_since_fire, imcy_inv) %>% 
            summarise(total_clusters1m = sum(total_clusters1m),
                      total_clusters2m = sum(total_clusters2m)))

tick_tree_data <- left_join(
      tick_data_plot_summary, 
      ungroup(tree_data_plot_summary))

tick_subplot_data <- left_join(
      tick_data_plot_summary,
      ungroup(subplot_plot_summary)
)

tick_data_sum <- join_all(list(tick_biomass_data, tick_canopycover_data, tick_quad10_data, tick_host_data, tick_host_data, tick_tree_data, tick_subplot_data, tick_vegcover_data))

summary(tick_data_sum)
```

# Project Summary

Tick-borne diseases (TBDs) represent a major public health threat in North America, particularly for military personnel training on Department of Defense (DoD) installations. We received funding from the Strategic Environmental Research and Development Programto explore several of the predicted consequences of climate change on fire regimes and plant communities, and their interactions with wildlife, for human risk of exposure to TBDs in the southeastern U.S.

![](pictures/serdp-flow-chart.png)

Our specific objectives are to:

1. Evaluate the interactions between fire and plant invasions spanning a gradient in fire management, invasive plant distribution and abundance, and climatic conditions across the southeastern U.S.

2. Quantify the effects of fire and plant invasions and their interactions on wildlife abundance, tick abundance, tick infection rates, and TBD risk to humans.

3. Calibrate a spatially explicit model of TBD risk in response to fire-invasion interactions   and examine the responses of fire, plant invasions, wildlife, TBD risk, using simulations of    climate change scenarios.

This progress report is intended to provide the managers at each installation that have granted access to collect data results from preliminary summaries and analyses of the data we collected. We emphasize that these are **preliminary results** summarizing the data and presenting general patterns of the relationships we are exploring with further statistical modeling. In most figures, the data points for `r paste(inst_name)` are highlighted in the context of the general pattern from plots sampled across all the installations.

###### Page break

# Number of plots sampled 

A total of `r n_plots` plot(s) were established and sampled at `r paste(inst_name)`. Of the `r n_plots`, there were `r n_plots_invaded_inst` plot(s) with a cogongrass invasion. 

```{r installation plots visited figure, fig.width=7.5}

plot_nums <- plot_visit_data %>%
      group_by(installation_full_name, imcy_inv, years_since_fire, plot_id) %>% 
      summarise(plot_ct = n_distinct(plot_id)) %>% 
      mutate(inst_flag = ifelse(installation_full_name==inst_name,T,F))
tot_plots <- plot_visit_data %>%
      group_by(installation_full_name, imcy_inv) %>% 
      summarise(plot_ct = n_distinct(plot_id)) %>% 
      mutate(inst_flag = ifelse(installation_full_name==inst_name,T,F))

tot_plots %>% 
      ungroup(.) %>% 
      mutate(installation_full_name = str_replace(installation_full_name, " ", "\n")
) %>% 
      ggplot(aes(installation_full_name, plot_ct, label=plot_ct)) +
      geom_col(aes(color = inst_flag), size = 4, show.legend = F) +
      geom_col(aes(fill = imcy_inv)) +
      scale_color_manual(values = c("TRUE" = "blue", "FALSE" = NA)) +
      invasion_fill +
      ylab("Number of sample plots") +
      xlab("") +
      scale_y_continuous(breaks = seq(0, 14, by = 7)) +
      theme_classic() +
      def_theme +
      theme(legend.direction = "vertical") +
      NULL

```

###### Page break

## Range of fire history at all installations

Across all installations, we established `r n_total_plots_all` plot(s) in areas ranging in time since last fire from `r min(filter(plot_visit_data, installation_full_name==inst_name)$years_since_fire, na.rm = T)` to `r max(filter(plot_visit_data, installation_full_name==inst_name)$years_since_fire, na.rm = T)` years. Of the `r n_total_plots_all`, there were `r n_total_plots_all_invaded` plot(s) with a cogongrass invasion.

``` {r fire invasion by installation figure}

plot_visit_data %>% 
      filter(!is.na(years_since_fire)) %>%
      ggplot(aes(as.factor(years_since_fire))) +
      geom_bar(aes(fill = imcy_inv), position = "dodge") +
      invasion_fill +
      ylab("Number of plots") +
      xlab("Years since fire") +
      theme_classic() +
      def_theme +
      theme(legend.position = c(.8,.9)) +
      NULL

```

###### Page break

## Range of fire history sampled `r paste("at ", inst_name)`

We established plots in areas at `r paste(inst_name)` ranging in time since last fire from `r min(filter(plot_visit_data, installation_full_name==inst_name)$years_since_fire, na.rm = T)` to `r max(filter(plot_visit_data, installation_full_name==inst_name)$years_since_fire, na.rm = T)` years.

```{r sampling fire history at specific installation figure}

plot_nums %>% 
      filter(!is.na(years_since_fire), installation_full_name==inst_name) %>%
      ggplot(aes(as.factor(years_since_fire), as.factor(plot_ct))) +
      geom_col(aes(fill = imcy_inv), position = "dodge") +
      invasion_fill +
      ylab("Number of plots") +
      xlab("Years since fire") +
      theme_classic() +
      def_theme +
      theme(legend.position = "none") +
      NULL

```

# Tick Abundance Relationships

## Raw tick abundance at each installation

```{r raw tick numbers figure caption processing}

n_total_raw_ticks_all <- sum(tick_data$tick_count)

n_raw_ticks_inst_2017 <- tick_data %>% 
      filter(installation_full_name==inst_name & visit_year==2017) %>% 
      # group_by(visit_year) %>%
      summarise(raw_ticks_sum = sum(.$tick_count))
      

n_raw_ticks_inst_2018 <- filter(tick_data, installation_full_name==inst_name & visit_year==2018)%>% 
  # group_by(visit_year) %>% 
  summarise(raw_ticks_sum = sum(.$tick_count))

#unique(tick_data$life_stage)
#filter(tick_data, life_stage=="Adult" & installation=="tyndall") %>% 
#  select(count, tick_count, life_stage) %>% 
#  summary(.)


```

A total of `r n_total_raw_ticks_all` ticks were collected across all installations. At `r paste(inst_name)` in `r n_raw_ticks_inst_2017` ticks were collected and in `r n_raw_ticks_inst_2018` ticks were collected. Note the different tick abundance scales on each panel.

```{r raw tick numbers by installation figure}

inst_data <- tick_data %>% 
  filter(installation_full_name==inst_name)
  
tick_data %>% 
             filter(!is.na(years_since_fire)) %>% 
             group_by(installation_full_name, years_since_fire, visit_year) %>%
             summarise(tick_count = sum(tick_count)) %>% 
      ggplot(aes(installation_full_name, tick_count, fill = installation_full_name)) +
      geom_col() +
      scale_fill_brewer(palette = "Set1") +
      facet_grid(visit_year~., scales = "free_y") +
      xlab("") +
      ylab("Tick abundance") +
      scale_y_continuous(breaks = seq(0, 250, by = 50)) +
      theme_bw() +
      theme(legend.position = "none",
            axis.text.x = element_text(angle = 290),
            panel.grid = element_blank(),
            strip.background = element_blank()) +
      NULL

```

## Tick abundance and fire history

The figure below shows the general relationship between the abundance of adult and nymph life-stage ticks (observations of larvae were counted as "1") across all the installations. The points contributed by `r paste(inst_name)` are highlighted in blue. The y-axis (tick abundance) is natural-log transformed, i.e., a value of 2 corresponds to exp(2) = `r round(exp(2))`. The total number of ticks collected at `r paste(inst_name)` was `r total_ticks`. 

```{r tick abundance fire all, eval = F}

inst_data <- tick_data %>% 
      filter(installation_full_name==inst_name) %>% 
      group_by(plot_id, years_since_fire, imcy_inv) %>%
      summarise(tick_count_sum = sum(tick_count, na.rm = T))

tick_data %>% 
      group_by(installation, plot_id, years_since_fire, imcy_inv) %>%
      summarise(tick_count_sum = sum(tick_count, na.rm = T)) %>%
      ungroup(.) %>% 
      filter(!is.na(imcy_inv)) %>% 

      ggplot(aes(years_since_fire, log1p(tick_count_sum))) +
      geom_point(aes(color = imcy_inv), position = "jitter", size = 1) +
      geom_smooth(aes(fill = imcy_inv, color = imcy_inv), method = "lm", alpha = .3, se=F) +
      geom_point(
            data = inst_data,
            aes(years_since_fire, log1p(tick_count_sum)), 
            color = "blue", size = 2
            ) +
      invasion_color +
      invasion_fill +
      scale_x_continuous(breaks = c(seq(0,11,1))) +
      xlab("Years since fire") +
      ylab("log(Tick abundance)") +
      theme_classic() +
      def_theme +
      theme(legend.direction = "vertical",
            legend.position = c(.15,.95)) +
      NULL

```

```{r tick abundance-fire log-linear relationship figure}

inst_data <- tick_data_plot_summary %>% 
  filter(installation_full_name==inst_name)

(tick_fire_fig <- ggplot(filter(tick_data_plot_summary, !is.na(imcy_inv)), 
       aes(years_since_fire, log1p(total_ticks))) +
      geom_smooth(aes(fill = imcy_inv, color = imcy_inv), se = T, method = "lm", alpha = .2) +
      geom_point(aes(color = imcy_inv)) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, log1p(total_ticks)), color = installation_color, size = 2)  +
      theme_classic() +
      xlab("Years since fire") +
      ylab("log(tick abundance + 1)") +
      def_theme +
      NULL)

```

## Tick abundance and percent litter cover

General trend tick abundance increases with percent litter cover.

```{r tick abundance vs litter cover figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

(tick_pctlitter_fig <- ggplot(filter(tick_data_sum, !is.na(imcy_inv)), 
       aes(avg_pct_litter, log1p(total_ticks), color = imcy_inv)) +
      geom_point() +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(avg_pct_litter, log1p(total_ticks)), color = installation_color, size = 2)  +
      geom_smooth(aes(fill = imcy_inv), se = T, alpha = .2, method = "lm", show.legend = T) +
      theme_classic() +
      xlab(expression(paste("Litter cover (%)"))) +
      ylab("log(tick abundance + 1)") +
      def_theme +
      NULL
)
```


## Tick abundance and average dry litter biomass

More litter biomass increases with tick abundance. 

```{r tick-litter-biomass figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

(tick_litter_mass_fig <- ggplot(
      filter(tick_data_sum, !is.na(imcy_inv)), 
       aes(avg_dry_litter_gm2, log1p(total_ticks), color = imcy_inv)) +
      geom_point() +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(avg_dry_litter_gm2, log1p(total_ticks)), color = installation_color, size = 2)  +
      geom_smooth(aes(fill = imcy_inv), se = T, alpha = .2, method = "lm", show.legend = F) +
      theme_classic() +
      xlab(expression(paste("Litter biomass (g ", m^{-2}, ")"))) +
      ylab("log(tick abundance + 1)") +
      def_theme
)
```

## Tick abundance and litter moisture

In uninvaded plots, tick abundance increases with litter moisture. No relationship in invaded.

```{r tick litter moisture figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

(tick_litter_mass_fig <- ggplot(
      filter(tick_data_sum, !is.na(imcy_inv)), 
       aes(avg_pct_litter_moisture, log1p(total_ticks), color = imcy_inv)) +
      geom_point(aes()) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(avg_pct_litter_moisture, log1p(total_ticks)), color = installation_color, size = 2)  +
      geom_smooth(aes(fill = imcy_inv), se = T, alpha = .2, method = "lm", show.legend = F) +
      theme_classic() +
      xlab(expression(paste("Litter moisture (%)"))) +
      ylab("log(tick abundance + 1)") +
      def_theme +
      NULL
)
```

## Tick abundance and canopy cover

More ticks in plots with more canopy cover.

```{r tick-canopy-cover figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

(tick_canopy_cover_fig <- ggplot(
      filter(tick_data_sum, !is.na(imcy_inv)), 
      aes(avg_canopy_cover, log1p(total_ticks), color = imcy_inv)) +
      geom_point() +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(avg_canopy_cover, log1p(total_ticks)), color = installation_color, size = 2)  +
      geom_smooth(aes(fill = imcy_inv), se = T, alpha = .2, method = "lm") +
      theme_classic() +
      xlab(expression(paste("Canopy cover (%)"))) +
      ylab("log(tick abundance + 1)") +
      def_theme +
      NULL
)
```

## Tick abundance and host density 

No relationship between host density and tick abundance

```{r tick-hosts relationship figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

(tick_host_fig1 <- ggplot(
      filter(tick_data_sum, !is.na(imcy_inv)), 
       aes(log1p(total_clusters1m), log1p(total_ticks), color = imcy_inv)) +
      geom_point() +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(log1p(total_clusters1m), log1p(total_ticks)), color = installation_color, size = 2)  +
      geom_smooth(aes(fill = imcy_inv), se = T, alpha = .2, method = "lm") +
      theme_classic() +
      xlab(expression(paste("log(dung clusters + 1)"))) +
      ylab("log(tick abundance + 1)") +
      def_theme +
      NULL
)
```

# Fire history relationships

## Canopy cover and years since fire

Canopy cover increases with time since fire

```{r create canopy cover years since fire figure}

inst_data <- canopy_cover_summary %>% 
  filter(installation_full_name==inst_name)

ggplot(canopy_cover_summary, aes(years_since_fire, avg_canopy_cover)) +
      geom_point(aes(color = imcy_inv)) +
      geom_smooth(aes(fill = imcy_inv, color = imcy_inv), method = "lm", alpha = .2) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, avg_canopy_cover), color = installation_color, size = 2)  +
      ylab("Overstory canopy cover (%)") +
      xlab("Years since last fire") +
      theme_classic() +
      def_theme +
      theme(legend.title = element_blank())
```

## Host density and years since fire

Host abundance tended to be slightly lower with increasing time since fire and canopy cover. The trend isn't significant.

```{r dung-host-fire history relationship figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

ggplot(filter(tick_data_sum, !is.na(imcy_inv)), 
        aes(years_since_fire, log1p(total_clusters1m))) +
      geom_point(aes(color = imcy_inv), alpha = .5) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, log1p(total_clusters1m)), color = installation_color, size = 2)  +
      geom_smooth(aes(color = imcy_inv, fill = imcy_inv), method = "lm", se = T, alpha = .2) +
      theme_classic() +
      xlab(expression(paste("Years since fire"))) +
      ylab("log(dung clusters + 1)") +
      def_theme
```

## Host density and canopy cover

Negative relationship with decreasing host density and canopy cover.

```{r dung-hosts-canopy-cover relationship figure}

inst_data <- tick_data_sum %>% 
  filter(installation_full_name==inst_name)

 ggplot(filter(tick_data_sum, !is.na(imcy_inv)), 
        aes(avg_canopy_cover, log1p(total_clusters1m))) +
      geom_point(aes(color = imcy_inv)) +
      invasion_color +
      invasion_fill +
   geom_point(data = inst_data, aes(avg_canopy_cover, log1p(total_clusters1m)), color = installation_color, size = 2)  +
      geom_smooth(aes(color = imcy_inv, fill = imcy_inv), method = "lm", se = T, alpha = .2) +
      theme_classic() +
      xlab(expression(paste("Canopy cover (%)"))) +
      ylab("log(dung clusters + 1)") +
      def_theme
```

## Deer specific dung clusters and years since fire

No relationship with host density (specifically deer) and time since fire.

```{r specific deer dung clusters figure}

inst_data <- dung_plot_data %>% 
  filter(installation_full_name==inst_name)

(deer_dung_fig <- dung_plot_data %>% filter(species=="deer") %>% 
      ggplot(
      aes(years_since_fire, log1p(total_clusters1m), color = imcy_inv)) +
      geom_point(size = 2) +
      invasion_fill +
      invasion_color +
      geom_point(data = inst_data, aes(years_since_fire, log1p(total_clusters1m)), 
            color = installation_color, size = 2)  +      
      geom_smooth(aes(fill = imcy_inv), se = T, method = "lm", alpha = .2) +
      theme_classic() +
      ylab("log(dung clusters + 1)") +
      xlab("Years since fire") +
      def_theme +
      NULL)
```

## Percent litter and years since fire

Percent litter increases with time since fire.

```{r pct-litter-fire figure, eval = T}

inst_data <- quadrat10_summaries %>% 
        filter(installation_full_name==inst_name)
               
(pct_litter_fig <- ggplot(quadrat10_summaries, aes(years_since_fire, avg_pct_litter)) +
      geom_point(aes(color = imcy_inv), size = 2) +
      # stat_summary(aes(color = imcy_inv), fun.data = "mean_se", geom = "pointrange") +
      geom_smooth(aes(color = imcy_inv, fill = imcy_inv), method = "lm", alpha = .2) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, avg_pct_litter), color = installation_color, size = 2)  +
      theme_classic() +
      def_theme +
      xlab("Years since fire") +
      ylab("Litter cover (%)") +
      # theme(legend.position = c(.85,.1)) +
      NULL
)
```

## Litter biomass and years since fire

Litter biomass increases with time since fire.

```{r litter biomass figure}

inst_data <- biomass_plot_summary %>% 
  filter(installation_full_name==inst_name)

(litter_mass_fig <- ggplot(biomass_plot_summary,
        aes(years_since_fire, avg_dry_litter_gm2, color = imcy_inv)) +
      geom_point() +
      geom_smooth(aes(fill = imcy_inv), alpha = .2, method = "lm") +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, avg_dry_litter_gm2), color = installation_color, size = 2) +
      theme_classic() +
      ylab(expression(paste("Litter biomass (g ", m^{-2}, ")"))) +
      xlab("Years since last fire") +
      def_theme
)

```

## Percent vegetation cover and years since fire

Uninvaded plots saw a decrease in herbaceous vegetation cover with time since fire. Cogongrass invaded plots had higher herbaceous vegetation cover.

```{r veg cover plot level figure}

inst_data <- veg_cover_plot_data %>% 
        filter(installation_full_name==inst_name)

(veg_cover_fig <- ggplot(veg_cover_plot_data,
      aes(years_since_fire, plot_avg_veg_cover)) +
      geom_point(aes(color = imcy_inv)) +
      geom_smooth(aes(color = imcy_inv, fill = imcy_inv), method = "lm", alpha = .2) +
      invasion_fill +
      invasion_color +
      geom_point(data = inst_data, aes(years_since_fire, plot_avg_veg_cover), color = installation_color, size = 2) +
      theme_classic() +
      ylab("Vegetation cover (%)") +
      xlab("Years since fire") +
   #  ggtitle("Plot averages for herbaceous vegetation cover") +
      def_theme +
      theme(legend.position = c(.8,.9)) +
      NULL
)

```

## Understory species richness and years since fire

Species richness at the quadrat level was highly variable, though tended to be highest during the first year following fire.

```{r plot richness fig}

inst_data <- species_richness %>% 
  filter(installation_full_name==inst_name)

(plot_richness_fig <- ggplot(species_richness, aes(years_since_fire, richness, color = imcy_inv)) +
      geom_smooth(show.legend = F, alpha = .2, aes(fill = imcy_inv), method = "lm") +
      geom_point(aes(color = imcy_inv), size = 1) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, richness), color = installation_color, size = 2) +
      theme_classic() +
      def_theme +
      ylab("Richness") +
      xlab("Years since fire") +
      #ggtitle("Plot understory species diversity") +
      theme(legend.position = c(.8,.8))
)
```

## Overstory species richness and years since fire

Tree species richness (>1m and >3cm dbh) increased with time since fire in invaded and uninvaded plots.

```{r tree richness figure}

inst_data <- tree_data_plot_summary %>% 
  filter(installation_full_name==inst_name)

(tree_richness_fig <- ggplot(tree_data_plot_summary, 
       aes(years_since_fire, richness, color = imcy_inv)) +
      geom_point(position = position_jitter(height = .05), alpha = .8) +
      geom_smooth(aes(fill = imcy_inv), method = "lm", alpha = .2) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, richness), color = installation_color, size = 2) +
      theme_classic() +
      def_theme +
      ylab("Richness") +
      xlab("Years since fire") +
      #ggtitle("Tree diversity vs. time since fire") +
      NULL
)

```

## Total tree DBH and years since fire

Some/no relationship with total tree DBH and time since fire.

```{r tree total dbh figure}

inst_data <- tree_data_plot_summary %>% 
  filter(installation_full_name==inst_name)

(tree_dbh_fig <- ggplot(tree_data_plot_summary, 
       aes(years_since_fire, total_dbh, color = imcy_inv)
       ) +
      geom_point() +
      geom_smooth(aes(fill = imcy_inv), method = "lm", se = T, alpha = .2) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, total_dbh), color = installation_color, size = 2) +
      theme_classic() +
      theme_classic() +
      xlab("Years since fire") +
      ylab("DBH (cm)") +
      #ggtitle("Total tree DBH across plots") +
      def_theme +
      NULL
)


```

## Proportion pine DBH and years since fire

This figure  represents the percentage of total DBH in a plot that is pine. The solid line is the overall mean regression fit, showing percent pine DBH decreasing with years since fire.

```{r proportion pine dbh figure}

inst_data <- tree_data_plot_summary %>% 
  filter(installation_full_name==inst_name)

(pct_pine_fig <- ggplot(filter(tree_data_plot_summary, pct_pinus_dbh>=0), 
       aes(years_since_fire, pct_pinus_dbh)
       ) +
      geom_smooth(method = "lm", se = F, alpha = .2) +
      geom_point(aes(color = imcy_inv)) +
      #geom_smooth(data=filter(tree_data_plot_summary, pct_pinus_dbh<60),
                  #aes(years_since_fire, pct_pinus_dbh),
                  #method = "lm", se = F, linetype="dashed", alpha = .2) +
       #geom_smooth(data=filter(tree_data_plot_summary, pct_pinus_dbh>60),
                  #aes(years_since_fire, pct_pinus_dbh),
                  #method = "lm", se = F, linetype="dotted", alpha = .2) +
      invasion_color +
      invasion_fill +
      geom_point(data = inst_data, aes(years_since_fire, pct_pinus_dbh), color = installation_color, size = 2) +
      theme_classic() +
      xlab("Years since fire") +
      ylab("Percent pine DBH ") +
      def_theme +
      NULL
)


```

# Supplementary Information - Commonly encountered tick species

## Lone star tick, *Amblyomma americanum*
**abbreviation: Am. am**

![](pictures/lone-star-ticks.png)

\newpage


## Gulf coast tick, *Amblyomma maculatum* 
**abbreviation: Am. mac**

![](pictures/gulf-coast-ticks.png)

\newpage

## American dog tick, *Dermecentor variablis* 
**abbreviation: De. var**

![](pictures/american-dog-ticks.png)

\newpage

## Brown dog tick, *Rhipicephalus sanguineus* 
**abbreviation: Rh. san**

![](pictures/brown-dog-ticks.png)

\newpage

## Black-legged or deer tick, *Ixodes scapularis* 
**abbreviation: Ix. sc**

![](pictures/deer-ticks.png)

\newpage

# Supplementary Information - Tick survival in cogongrass invasions

## Project Background

Recent studies demonstrate that invasive plants can alter TBD risk via both direct effects on tick survival and indirect effects mediated by tick hosts. For example, *Microstegium vimineum* has been shown experimentally to reduce survival of *A. americanum* (lone star tick) and *Dermacentor variabilis* (American dog tick) relative to native vegetation `r citep("Civitello 2008 Journal of Medical Entomology")`; conversely the removal of invasive *Berberis thunbergii* (Japanese barberry) significantly reduces the survival of *I. scapularis* `r citep("10.1603/EN10131")`. Thus both positive and negative direct effects of invasive plants on tick survival have the potential to influence tick population dynamics. There is also growing evidence of indirect effects mediated by host responses to plant invasions, including increased infestation of *Peromyscus leucopus* (white-footed mice) by *I. scapularis* in mixed stands of invasive shrubs `r citep(list("10.1603/0022-2585(2006)43[1142:DBREUA]2.0.CO;2", "10.1603/022.038.0404"))` and increased abundance of *A. americanum* due to attraction of white-tailed deer to dense thickets of *Lonicera maackii* (Amur honeysuckle) `r citep("10.1073/pnas.1008362107")`.

**No ecological studies have addressed the effects of plant invasions and potential interactions with climate change or fire regimes for TBD risk.**

This project conducts a survival assay of *A. americanum* to assess tick mortality and plant invasion interactions, as well as microclimate suitability for tick survival. For this assay we will deploy **1** mesh bag containing **10 nymph** and **10 adult** (5 male and 5 female) life stage *A. americanum* ticks in **12** *I. cylindrica* invaded and **12** native plots (1 m x 1 m) in a pine dominated forest habitat. Each mesh bag will be stood up vertically at the litter layer (to mimic natural questing habitat) inside of a constructed metal wire cage to deter scavengers. Microclimate data is taken by temperature and relative humidity loggers that are attached in a PVC housing next to the cage that record measurements every 5 minutes. Ticks were checked regularly approximately every **10-14** days to monitor their survival. Below are the figures for tick survival since launch on June 1, 2018. Ticks will be monitored continuously until all tick life stage morality has reached 100%.

### Comparative Tick Survival

Comparison of adult and nymph life stages of the lone star tick in native and invaded sample plots. All life stages see a higher mortality in native plots, with nymphs feeling the effects in a shorter amount of time.

![](figures/tick-survival-assay/survivalfigsTogether.png)

```{r import tick-survival-assay}

```

\newpage


# Supplementary Information - Cogongrass fire temperatures from small scale experiments


**(a)** The “maximum temperature” at each height is the average of the maximum temperatures from the three temperature probes located at that height. For some of the fires with the lowest amount of biomass (250 g) the probe temperature did not deviate from near-ambient.

**(b)** The "seconds above 100°C"" accounts for the amount of time temperature probes recorded temperatures above 100°C at each of the heights for each biomass amount.

![](figures/temperature-fig.png)


```{r import cogon-fire-data}

```
